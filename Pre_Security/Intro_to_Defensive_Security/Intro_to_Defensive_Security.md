# مقدمة عن الأمن الدفاعي | Intro to Defensive Security

### المهمّة الأولى: مقدمة عن الأمن الدفاعي

يركز الأمن الهجومي على شيء واحد: اختراق الأنظمة. يمكن تحقيق اختراق الأنظمة من خلال استغلال الأخطاء وإساءة استخدام الإعدادات غير الآمنة والاستفادة من سياسات التحكم في الوصول غير المطبقة، من بين أمور أخرى. تتخصص الفرق الحمراء ومختبرو الاختراق في الأمن الهجومي.

يعد الأمن الدفاعي عكسًا إلى حد ما للأمن الهجومي، حيث إنه يهتم بمهمتين رئيسيتين:

1. منع حدوث الاختراقات
2. اكتشاف الاختراقات عند حدوثها والاستجابة لها بشكل صحيح

الفرق الزرقاء هي جزء من المشهد الأمني ​​الدفاعي.

![[tryhackme.com_r_room_defensivesecurity.png]]

تتضمن بعض المهام المتعلقة بالأمن الدفاعي ما يلي:

- توعية المستخدمين بالأمن السيبراني: يساعد تدريب المستخدمين على الأمن السيبراني في الحماية من الهجمات المختلفة التي تستهدف أنظمتهم.
- توثيق وإدارة الأصول: نحتاج إلى معرفة أنواع الأنظمة والأجهزة التي يتعين علينا إدارتها وحمايتها بشكل صحيح.
- تحديث الأنظمة وتصحيحها: التأكد من تحديث أجهزة الكمبيوتر والخوادم وأجهزة الشبكة بشكل صحيح وتصحيحها ضد أي ثغرة أمنية معروفة (ضعف).
- إعداد أجهزة الأمن الوقائي: تعد جدران الحماية وأنظمة منع التطفل (IPS) مكونات أساسية للأمن الوقائي. تتحكم جدران الحماية في حركة مرور الشبكة التي يمكن أن تدخل إلى النظام أو الشبكة وما يمكن أن تخرج منه. تمنع أنظمة منع التطفل أي حركة مرور على الشبكة تتطابق مع القواعد الحالية وتوقيعات الهجوم.
- إعداد أجهزة التسجيل والمراقبة: بدون التسجيل والمراقبة المناسبين للشبكة، لن يكون من الممكن اكتشاف الأنشطة الضارة والتطفلات. إذا ظهر جهاز غير مصرح به جديد على شبكتنا، فيجب أن نكون قادرين على معرفة ذلك.

هناك الكثير مما يتعلق بالأمن الدفاعي، والقائمة أعلاه تغطي فقط عددًا قليلاً من الموضوعات الشائعة.

في هذه الغرفة، نغطي:

- مركز عمليات الأمان (SOC)، (Security Operations Center)
- استخبارات التهديدات (Threat Intelligence)
- التحليل الجنائي الرقمي والاستجابة للحوادث (DFIR)، (Digital Forensics and Incident Response)
- تحليل البرامج الضارة (Malware Analysis)

أجب عن الأسئلة أدناه:

أي فريق يركز على الأمن الدفاعي؟

`Blue Team`

---

### المهمّة الثانية: مجالات الأمن الدفاعي

في هذه المهمة، سنغطي موضوعين رئيسيين يتعلقان بالأمن الدفاعي:

- مركز عمليات الأمن (SOC)، حيث نغطي Threat Intelligence
- التحليل الجنائي الرقمي والاستجابة للحوادث (DFIR)، حيث نغطي أيضًا تحليل البرامج الضارة

**مركز عمليات الأمان (SOC)**

مركز عمليات الأمان (SOC) هو فريق من المتخصصين في الأمن السيبراني الذين يراقبون الشبكة وأنظمتها للكشف عن أحداث الأمن السيبراني الضارة. بعض المجالات الرئيسية التي تهم مركز عمليات الأمان هي:

- الثغرات الأمنية: كلما تم اكتشاف ثغرة أمنية في النظام، فمن الضروري إصلاحها عن طريق تثبيت تحديث أو تصحيح مناسب. وعندما لا يتوفر الإصلاح، يجب اتخاذ التدابير اللازمة لمنع المهاجم من استغلاله. ورغم أن إصلاح الثغرات الأمنية يشكل أهمية حيوية لمركز العمليات الأمنية، فإنه لا يتم تعيينه له بالضرورة.
- انتهاكات السياسة: يمكننا أن نفكر في سياسة الأمان كمجموعة من القواعد المطلوبة لحماية الشبكة والأنظمة. على سبيل المثال، قد يكون انتهاكًا للسياسة إذا بدأ المستخدمون في تحميل بيانات سرية للشركة إلى خدمة تخزين عبر الإنترنت.
- النشاط غير المصرح به: ضع في اعتبارك الحالة التي يتم فيها سرقة اسم تسجيل الدخول وكلمة المرور للمستخدم، ويستخدمهما المهاجم لتسجيل الدخول إلى الشبكة. يحتاج مركز العمليات الأمنية إلى اكتشاف مثل هذا الحدث وحظره في أقرب وقت ممكن قبل حدوث المزيد من الضرر.
- اختراقات الشبكة: بغض النظر عن مدى جودة الأمان لديك، فهناك دائمًا فرصة للاختراق. يمكن أن يحدث الاختراق عندما ينقر المستخدم على رابط ضار أو عندما يستغل المهاجم خادمًا عامًا. في كلتا الحالتين، عندما يحدث أي اختراق، يجب علينا اكتشافه في أقرب وقت ممكن لمنع المزيد من الضرر.

تشمل العمليات الأمنية مهام مختلفة لضمان الحماية؛ إحدى هذه المهام هي استخبارات التهديدات.

![[Pasted image 20240924060409.png]]

**استخبارات التهديد | Threat Intelligence**

في هذا السياق، تشير الاستخبارات إلى المعلومات التي تجمعها عن الأعداء الفعليين والمحتملين. التهديد هو أي إجراء يمكن أن يعطل أو يؤثر سلبًا على النظام. تهدف استخبارات التهديد إلى جمع المعلومات لمساعدة الشركة على الاستعداد بشكل أفضل ضد الخصوم المحتملين. والغرض من ذلك هو تحقيق دفاع مستنير بالتهديدات. لدى الشركات المختلفة خصوم مختلفون. قد يسعى بعض الخصوم إلى سرقة بيانات العملاء من مشغل الهاتف المحمول؛ ومع ذلك، فإن الخصوم الآخرين مهتمون بوقف الإنتاج في مصفاة البترول. تشمل أمثلة الخصوم جيشًا إلكترونيًا تابعًا لدولة قومية يعمل لأسباب سياسية ومجموعة برامج فدية تعمل لأغراض مالية. بناءً على الشركة (الهدف)، يمكننا توقع الخصوم.

![[Pasted image 20240924060454.png]]

تحتاج الاستخبارات إلى البيانات. يجب جمع البيانات ومعالجتها وتحليلها. يتم جمع البيانات من مصادر محلية مثل سجلات الشبكة والمصادر العامة مثل المنتديات. تهدف معالجة البيانات إلى ترتيبها في تنسيق مناسب للتحليل. تسعى مرحلة التحليل إلى العثور على مزيد من المعلومات حول المهاجمين ودوافعهم؛ علاوة على ذلك، تهدف إلى إنشاء قائمة بالتوصيات والخطوات القابلة للتنفيذ.

يتيح لك التعرف على خصومك معرفة تكتيكاتهم وتقنياتهم وإجراءاتهم. نتيجة للاستخبارات المتعلقة بالتهديدات، نحدد الجهة الفاعلة في التهديد (الخصم)، ونتنبأ بنشاطها، وبالتالي، سنكون قادرين على التخفيف من حدة هجماتهم وإعداد استراتيجية للاستجابة.

**الأدلة الرقمية والاستجابة للحوادث (DFIR)**

يتناول هذا القسم الأدلة الرقمية والاستجابة للحوادث (DFIR)، وسوف نغطي:
- التحليلات الرقمية الجنائية
- الاستجابة للحوادث
- تحليل البرامج الضارة

**التحقيق الجنائي الرقمي | Digital Forensics**

التحقيق الجنائي الرقمي هو تطبيق العلم للتحقيق في الجرائم وإثبات الحقائق. ومع استخدام وانتشار الأنظمة الرقمية، مثل أجهزة الكمبيوتر والهواتف الذكية، نشأ فرع جديد من التحقيق الجنائي الرقمي للتحقيق في الجرائم ذات الصلة: التحقيق الجنائي للحواسيب، والذي تطور لاحقًا إلى التحقيق الجنائي الرقمي.

في مجال الأمن الدفاعي، يتحول تركيز التحقيق الجنائي الرقمي إلى تحليل أدلة الهجوم ومرتكبيه ومجالات أخرى مثل سرقة الملكية الفكرية والتجسس الإلكتروني وحيازة محتوى غير مصرح به. وبالتالي، سيركز التحقيق الجنائي الرقمي على مجالات مختلفة مثل:

- نظام الملفات: يكشف تحليل الصورة الجنائية الرقمية (نسخة منخفضة المستوى) لتخزين النظام عن الكثير من المعلومات، مثل البرامج المثبتة والملفات التي تم إنشاؤها والملفات التي تم الكتابة فوقها جزئيًا والملفات المحذوفة.
- ذاكرة النظام: إذا كان المهاجم يشغل برنامجه الخبيث في الذاكرة دون حفظه على القرص، فإن أخذ صورة جنائية (نسخة منخفضة المستوى) من ذاكرة النظام هي أفضل طريقة لتحليل محتوياتها ومعرفة المزيد عن الهجوم.
- سجلات النظام: يحتفظ كل كمبيوتر عميل وخادم بملفات سجل مختلفة حول ما يحدث. توفر ملفات السجل الكثير من المعلومات حول ما حدث على النظام. سيتم ترك بعض الآثار حتى إذا حاول المهاجم مسح آثاره.
- سجلات الشبكة: تساعد سجلات حزم الشبكة التي عبرت الشبكة في الإجابة على المزيد من الأسئلة حول ما إذا كان الهجوم يحدث وما يستلزمه.

**الاستجابة للحوادث**

عادةً ما يشير مصطلح "الحدث" إلى خرق البيانات أو الهجوم الإلكتروني؛ ومع ذلك، في بعض الحالات، قد يكون الأمر أقل خطورة، مثل سوء الاعداد أو محاولة التسلل أو انتهاك السياسة. تشمل أمثلة الهجوم الإلكتروني قيام أحد المهاجمين بجعل شبكتنا أو أنظمتنا غير قابلة للوصول، أو تشويه (تغيير) الموقع الإلكتروني العام، أو خرق البيانات (سرقة بيانات الشركة). كيف تستجيب لهجوم إلكتروني؟ تحدد الاستجابة للحوادث المنهجية التي يجب اتباعها للتعامل مع مثل هذه الحالة. والهدف هو تقليل الضرر والتعافي في أقصر وقت ممكن. من الناحية المثالية، يجب عليك تطوير خطة جاهزة للاستجابة للحوادث.

المراحل الأربع الرئيسية لعملية الاستجابة للحوادث هي:

1. التحضير: يتطلب هذا فريقًا مدربًا ومستعدًا للتعامل مع الحوادث. ومن الناحية المثالية، يتم وضع تدابير مختلفة لمنع وقوع الحوادث في المقام الأول.
2. الكشف والتحليل: يمتلك الفريق الموارد اللازمة للكشف عن أي حدث؛ وعلاوة على ذلك، من الضروري إجراء تحليل إضافي لأي حدث تم اكتشافه لمعرفة مدى خطورته.
3. الاحتواء والقضاء والتعافي: بمجرد اكتشاف حادث ما، من الأهمية بمكان منعه من التأثير على الأنظمة الأخرى والقضاء عليه واستعادة الأنظمة المتأثرة. على سبيل المثال، عندما نلاحظ أن النظام مصاب بفيروس كمبيوتر، نود إيقاف (احتواء) الفيروس من الانتشار إلى أنظمة أخرى وتنظيف (القضاء) على الفيروس وضمان استعادة النظام بشكل صحيح.
4. النشاط بعد الحدث: بعد التعافي الناجح، يتم إعداد تقرير ومشاركة الدرس المستفاد لمنع وقوع حوادث مماثلة في المستقبل.

![[Pasted image 20240924064151.png]]

**تحليل البرامج الضارة**

البرامج الضارة هي البرامج الخبيثة. تشير البرامج إلى البرامج والمستندات والملفات التي يمكنك حفظها على القرص أو إرسالها عبر الشبكة. تتضمن البرامج الضارة العديد من الأنواع، مثل:

- الفيروس هو جزء من الكود (جزء من برنامج) يلتصق ببرنامج. وهو مصمم للانتشار من جهاز كمبيوتر إلى آخر؛ وعلاوة على ذلك، فهو يعمل عن طريق تغيير الملفات والكتابة فوقها وحذفها بمجرد إصابته لجهاز كمبيوتر. وتتراوح النتيجة من أن يصبح الكمبيوتر بطيئًا إلى أن يصبح غير قابل للاستخدام.
- حصان طروادة (Trojans) هو برنامج يظهر وظيفة مرغوبة واحدة ولكنه يخفي وظيفة ضارة تحتها. على سبيل المثال، قد يقوم الضحية بتنزيل مشغل فيديو من موقع ويب مشبوه يمنح المهاجم السيطرة الكاملة على نظامه.
- برنامج الفدية هو برنامج ضار يقوم بتشفير ملفات المستخدم. يجعل التشفير الملفات غير قابلة للقراءة دون معرفة كلمة مرور التشفير. يقدم المهاجم للمستخدم كلمة مرور التشفير إذا كان المستخدم على استعداد لدفع "فدية".

![[Pasted image 20240924064325.png]]

يهدف تحليل البرامج الضارة إلى التعرف على هذه البرامج الضارة باستخدام وسائل مختلفة:

1. يعمل التحليل الثابت عن طريق فحص البرنامج الضار دون تشغيله. وعادةً ما يتطلب هذا معرفة قوية بلغة التجميع (مجموعة تعليمات المعالج، أي التعليمات الأساسية للكمبيوتر).
2. يعمل التحليل الديناميكي عن طريق تشغيل البرامج الضارة في بيئة خاضعة للرقابة ومراقبة أنشطتها. ويتيح لك ملاحظة سلوك البرامج الضارة عند تشغيلها.

أجب على الأسئلة أدناه:

كيف يمكنك تسمية فريق من المتخصصين في الأمن السيبراني الذي يراقب الشبكة وأنظمتها بحثًا عن الأحداث الضارة؟
`Security Operations Center`

ماذا يعني DFIR؟
`Digital Forensics and Incident Response`

ما هو نوع البرمجيات الخبيثة التي تتطلب من المستخدم دفع المال لاستعادة الوصول إلى ملفاته؟
`ransomware`

---

### المهمّة الثالثة: مثال عملي للأمن الدفاعي

ما هي المهمة النموذجية التي ستقوم بها كمحلل أمني؟ انقر فوق "عرض الموقع" للمتابعة حتى تحصل على flag. (إذا كانت هذه هي المرة الأولى التي تحصل فيها على flags، فيمكن رؤية العلامة كسلسلة نصية تتلقاها بمجرد إنجاز مهمة. ومن الأمثلة على العلامات `FLAG{WORDS_AND_MORE}`.)

![[tryhackme.com_r_room_defensivesecurity 1.png]]

![[Pasted image 20240924064744.png]]

أنت جزء من مركز عمليات الأمان (SOC) المسؤول عن حماية أحد البنوك. يستخدم مركز عمليات الأمان الخاص بهذا البنك نظام إدارة المعلومات الأمنية والأحداث (SIEM). يجمع نظام إدارة المعلومات الأمنية والأحداث (SIEM) المعلومات والأحداث المتعلقة بالأمان من مصادر مختلفة ويقدمها عبر نظام واحد. على سبيل المثال، سيتم إخطارك في حالة وجود محاولة تسجيل دخول فاشلة أو محاولة تسجيل دخول من موقع جغرافي غير متوقع. علاوة على ذلك، مع ظهور التعلم الآلي، قد يكتشف نظام إدارة المعلومات الأمنية والأحداث سلوكًا غير عادي، مثل تسجيل دخول المستخدم في الساعة 3 صباحًا عندما يقوم عادةً بتسجيل الدخول فقط خلال ساعات العمل.

في هذا التمرين، سنتفاعل مع نظام إدارة المعلومات الأمنية والأحداث لمراقبة الأحداث المختلفة على شبكتنا وأنظمتنا في الوقت الفعلي. بعض الأحداث نموذجية وغير ضارة؛ قد تتطلب أحداث أخرى تدخلاً إضافيًا منا. ابحث عن الحدث المميز باللون الأحمر، ولاحظه، وانقر فوقه لمزيد من الفحص.

بعد ذلك، نريد معرفة المزيد حول النشاط أو الحدث المشبوه. ربما تم تشغيل الحدث المشبوه بواسطة حدث، مثل مستخدم محلي أو كمبيوتر محلي أو عنوان IP بعيد. لإرسال واستقبال البريد العادي، تحتاج إلى عنوان فعلي؛ وبالمثل، تحتاج إلى عنوان IP لإرسال واستقبال البيانات عبر الإنترنت. عنوان IP هو عنوان منطقي يسمح لك بالتواصل عبر الإنترنت. نقوم بفحص سبب المحفز للتأكد مما إذا كان الحدث ضارًا بالفعل. إذا كان ضارًا، فيجب علينا اتخاذ الإجراء المناسب، مثل الإبلاغ لشخص آخر في مركز العمليات الأمنية وحظر عنوان IP.

أجب على الأسئلة أدناه:

ما هو العلم الذي حصلت عليه من خلال المتابعة؟
`THM{THREAT-BLOCKED}`

